s â† â€¢Import "bqn-libs/strings.bqn"

data â† â€¢file.Lines "5_input.txt"

Parse â† {s.ToNumsÂ¨ ((âˆ¨Â´ğ•¨âŠ¸=)âŠ0Â¨)âŠ¸/ ğ•©}

rdata â† '|' Parse data

udata â† ',' Parse data

UpdateRules â† {rs ğ•Š u: (âˆ§Â´Â¨+Ë>(rdataâŠ¸=)Â¨ u) / rs}

CheckRule â† {rs ğ•Š u: âˆ§Â´1>-Â´Â¨ uâŠ¸âŠÂ¨rs}

ValidUpdates â† {rs ğ•Š updates: ur â† rsâŠ¸UpdateRulesÂ¨ updates â‹„ ur CheckRuleÂ¨ updates}

Count â† {+Â´ {âŒŠâˆ˜Ã·âŸœ2âˆ˜â‰ âŠ¸âŠ‘ğ•©}Â¨ ğ•©}

Del â† {(ğ•¨âŠ¸â†‘âˆ¾(ğ•¨+1)âŠ¸â†“) ğ•©}

Ins â† {vâ€¿i ğ•Š ğ•©: (iâ†‘ğ•©)âˆ¾vâˆ¾(iâ†“ğ•©)}

# Left > Right

LGR â† { ğ•Š lâ€¿râ€¿liâ€¿riâ€¿ls: (=âŸœâ‰ âŸœls)â—¶âŸ¨ lâ€¿(ri) Ins li Del ls â‹„ l âˆ¾ ls âŸ© li }

# Left < Right

LLR â† { ğ•Š lâ€¿râ€¿liâ€¿riâ€¿ls: (=âŸœâ‰ âŸœls)â—¶âŸ¨ls â‹„ ls âˆ¾ r âŸ© ri }

Apply â† { 
    lâ€¿r ğ•Š ls : 
        li â† âŠ‘ls âŠ l 
        ri â† âŠ‘ls âŠ r 
        Ã—â—¶âŸ¨ 
            (lâ€¿râˆ¾ls) 
            LGR lâ€¿râ€¿liâ€¿riâ€¿ls 
            LLR lâ€¿râ€¿liâ€¿riâ€¿ls 
        âŸ© li-ri 
}

B â† {Count ğ•¨ {ğ•© {(â‰¢âŸœğ•¨)â—¶âŸ¨ğ•¨, ğ•ŠâŸœğ•©âŸ© ğ•¨ ApplyÂ´ ğ•©}Â¨ ğ•¨âŠ¸UpdateRulesÂ¨ğ•©} (Â¬ğ•¨ ValidUpdates ğ•©)/ğ•©}

â€¢Show rdata B udata

