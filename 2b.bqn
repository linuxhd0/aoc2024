strings ‚Üê ‚Ä¢Import "bqn-libs/strings.bqn"

data ‚Üê strings.ToNums¬® ‚Ä¢file.Lines "2_input.txt"

Order ‚Üê (‚àß¬¥‚äë‚ä∏=)¬®(√ó(-¬¥Àò2‚ä∏‚Üï))¬®
Distance ‚Üê (‚àß¬¥¬∑(4‚ä∏>‚àß0‚ä∏<)¬∑|‚àò-¬¥Àò2‚ä∏‚Üï)
Safe ‚Üê Order‚àßDistance¬®

+¬¥ Safe data

unsafe ‚Üê (¬¨‚àòSafe)‚ä∏/data

# ¬¨ identity matrix
Nim ‚Üê ¬¨=‚åúÀú‚Üï

DampedSafe ‚Üê {‚à®¬¥Safe (<ÀòNim(‚â†ùï©))/¬®(‚â†ùï©)/‚ãàùï©}¬® 

‚Ä¢Show +¬¥ (DampedSafe unsafe) ‚àæ Safe data

