data â† â€¢file.Lines "3_input.txt"

s â† â€¢Import "bqn-libs/strings.bqn"

nums â† "0123456789"

# Numbers â† { 
#    ne/Ëœâˆ§Â´Â¨                          # keep those lists that begin and end with a number
#    (1âŠ¸â†‘âˆ¾Â¯1âŠ¸â†‘)âŠ¸âˆŠâŸœnumsÂ¨               # find lists that begin and end with a number
#    ne â† (0âŠ¸<âˆ˜â‰ Â¨/âŠ¢)                  # find non empty lists
#    âˆ¾ ")"âŠ¸s.SplitÂ¨ "mul(" s.Split ğ•©  # split the data by "mul(" and ")" 
# }

Numbers â† { ne/Ëœâˆ§Â´Â¨(1âŠ¸â†‘âˆ¾Â¯1âŠ¸â†‘)âŠ¸âˆŠâŸœnumsÂ¨ neâ†(0âŠ¸<âˆ˜â‰ Â¨/âŠ¢) âˆ¾ ")"âŠ¸s.SplitÂ¨ "mul(" s.Split ğ•© }

# Happens to work on this data but would fail on "mul(123,123,123)".
                            
Mult â† {+Â´Ã—Â´âˆ˜(â€¢ParseFloatâŠ0Â¨)Â¨ ','âŠ¸s.SplitÂ¨ Numbers ğ•©}

# p = The previous group's value
# l = The last seen value
# c = The current value
# k = Whether or not we should keep this value

DoMask â† {
    pâ€¿lâ€¿k ğ•Š c: c = l ? ğ•¨     ;
    pâ€¿lâ€¿k ğ•Š c: c < l ? lâ€¿câ€¿0 ;
    pâ€¿lâ€¿k ğ•Š c:         lâ€¿câ€¿1
}

DosAndDonts â† +`(("do()"âŠ¸s.Locate)+(-"don't()"âŠ¸s.Locate))

Masked â† {ğ•© /Ëœ Â¯1âŠ‘Ë˜>(<0â€¿0â€¿1) DoMask` DosAndDonts ğ•©}

â€¢Show Mult Masked âˆ¾ data
