âŸ¨MoveâŸ© â‡
data â† â€¢file.Lines "15_input.txt"

Parse â† {
  mapâ€¿Â·â€¿moves â† (+`Â·Â»âŠ¸+âŸ¨âŸ©âŠ¸â‰¡Â¨)âŠ¸âŠ” ğ•©
  (>map)â€¿(âˆ¾moves)
}

mapâ€¿moves â† Parse data

Ahead â† {
  '<' ğ•Š m: +`Ë˜âŒ¾(âŒ½Ë˜)'@'=m;
  'v' ğ•Š m: +`      '@'=m;
  '>' ğ•Š m: +`Ë˜     '@'=m;
  '^' ğ•Š m: +`âŒ¾âŒ½    '@'=m
}

ComplexMove â† {
  ğ•Š view:
    s â† view âŠ‘âˆ˜âŠ '.'
    w â† view âŠ‘âˆ˜âŠ '#'
    (s<w)â—¶âŸ¨âŠ¢, (1âŠ¸âŒ½â¼)âŒ¾((s+1)âŠ¸â†‘)âŸ© view
}

Move â‡ {
  ğ•Š view:
    {âŠ‘1 âŠËœ âŸ¨"@#", "@."âŸ© â‰¡âŸœ(2âŠ¸â†‘)Â¨ ğ•©}â—¶âŸ¨view, {âŒ½âŒ¾(2âŠ¸â†‘) view}, ComplexMoveâˆ˜âŠ‘âŸ© <view
}

Go â† {
  dir ğ•Š map:
    view_mask â† â¥Š  dir Ahead map
    dmap â† â¥Š map
    view â† view_mask / dmap
    new_view â† (âŠ‘âˆ˜âˆŠâŸœ"<^")â—¶âŸ¨{Move view}, {MoveâŒ¾âŒ½view}âŸ© dir
    new_map â† new_viewâŒ¾(view_maskâŠ¸/) dmap
    (â‰¢map)â¥Šnew_map
}

â€¢Show +Â´â¥Š100â€¿1âŠ¸Ã—Ë˜>(('O'âŠ¸=)/â—‹â¥Š(â†•âˆ˜â‰¢)) GoÂ´ (âŒ½moves) âˆ¾ <map

